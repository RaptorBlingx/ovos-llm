# üîç OVOS EnMS 1-by-1 End-to-End Testing Plan

**Purpose:** Systematically test EVERY EnMS API endpoint (ALL 44) with OVOS voice queries to ensure 100% coverage  
**Methodology:** For each query ‚Üí Run curl ‚Üí Run OVOS ‚Üí Compare outputs ‚Üí Mark PASS/FAIL ‚Üí Fix ‚Üí Iterate  
**Success Criteria:** ALL queries pass before deployment  
**Status:** READY FOR TESTING  
**Date:** November 20, 2025

---

## üéØ WHY THIS DOCUMENT EXISTS

**Problem:**
- OVOS currently has ~40% API coverage (12/30 endpoints working)
- Known failures:
  - "energy efficiency this week" ‚Üí Calls wrong endpoint (returns current energy, not time-series)
  - "predict for 500 units" ‚Üí Misclassified as ANOMALY_DETECTION instead of FORECAST
  - "expected energy for Compressor-1" ‚Üí Returns current energy instead of baseline prediction

**Solution:**
- Test EVERY API endpoint one-by-one
- Each endpoint gets 5-12 unique queries
- Each query gets unique curl command to compare API vs OVOS
- Fix failures immediately before moving forward
- Achieve 100% coverage (44/44 endpoints working)

**How to Use This File:**
1. Start with BATCH 1, EP1, Query 1.1
2. Run curl command ‚Üí Save output
3. Run OVOS query ‚Üí Save response
4. Compare: Intent ‚úì API ‚úì Params ‚úì Response Match ‚úì Voice-Friendly ‚úì
5. Mark PASS or FAIL
6. If FAIL ‚Üí Document issue ‚Üí Fix code ‚Üí Re-test ‚Üí Iterate until PASS
7. Move to next query ONLY after current query PASSES
8. Complete all queries in endpoint before moving to next endpoint
9. Complete all endpoints in batch before moving to next batch

**Environment:**
- OVOS Service: `systemctl status ovos-core`
- EnMS API: `http://10.33.10.109:8001`
- Tools: `jq`, `curl`, 3 terminals (logs, curl, OVOS)

---

## üìä COMPLETE ENDPOINT INVENTORY

### BATCH 1: Core System Health (3 endpoints)
1. `GET /api/v1/health` - Health Check
2. `GET /api/v1/stats/system` - System Statistics
3. `GET /api/v1/stats/aggregated` - Aggregated Statistics

### BATCH 2: Machine Discovery & Info (5 endpoints)
4. `GET /api/v1/machines` - List/Search Machines
5. `GET /api/v1/machines/{machine_id}` - Get Single Machine by ID
6. `GET /api/v1/machines/status/{machine_name}` - ‚≠ê Machine Status by Name (CRITICAL)
7. `GET /api/v1/machines/{machine_id}/status-history` - Status History
8. `GET /api/v1/production/{machine_id}` - Production Data

### BATCH 3: Time-Series Data (4 endpoints)
9. `GET /api/v1/timeseries/energy` - ‚≠ê Energy Time-Series (CRITICAL - FAILING)
10. `GET /api/v1/timeseries/power` - Power Time-Series
11. `GET /api/v1/timeseries/latest/{machine_id}` - Latest Reading
12. `GET /api/v1/timeseries/multi-machine/energy` - Multi-Machine Comparison

### BATCH 4: Anomaly Detection (4 endpoints)
13. `POST /api/v1/anomaly/detect` - Detect Anomalies
14. `GET /api/v1/anomaly/recent` - Recent Anomalies
15. `GET /api/v1/anomaly/active` - Active Anomalies
16. `GET /api/v1/anomaly/search` - Search Anomalies (with date range)

### BATCH 5: Baseline Prediction Models (4 endpoints)
17. `GET /api/v1/baseline/models` - List Baseline Models
18. `POST /api/v1/baseline/predict` - ‚≠ê Predict Expected Energy (CRITICAL - FAILING)
19. `GET /api/v1/baseline/model/{model_id}` - Model Details with Explanation
20. `POST /api/v1/baseline/train-seu` - Train Baseline Model

### BATCH 6: KPIs & Performance Analytics (6 endpoints)
21. `GET /api/v1/kpi/all` - All KPIs
22. `GET /api/v1/kpi/energy-cost` - Energy Cost KPIs
23. `POST /api/v1/performance/analyze` - SEU Performance Analysis
24. `GET /api/v1/performance/health` - Performance Engine Health
25. `GET /api/v1/performance/opportunities` - Improvement Opportunities
26. `POST /api/v1/performance/action-plan` - Create Action Plan

### BATCH 7: Forecasting (2 endpoints)
27. `GET /api/v1/forecast/short-term` - Short-term Forecast (recommended)
28. `GET /api/v1/forecast/demand` - Energy Demand Forecast (deprecated)

### BATCH 8: Factory & Analytics (4 endpoints)
29. `GET /api/v1/seus` - List SEUs (Significant Energy Uses)
30. `GET /api/v1/factory/summary` - Factory Summary
31. `GET /api/v1/analytics/top-consumers` - ‚≠ê Top Consumers / Ranking (CRITICAL)
32. `GET /api/v1/production/{machine_id}` - Production Metrics

### BATCH 9: Multi-Energy Support (3 endpoints)
33. `GET /api/v1/machines/{id}/energy-types` - List Energy Types
34. `GET /api/v1/machines/{id}/energy/{type}` - Get Readings by Energy Type
35. `GET /api/v1/machines/{id}/energy-summary` - Multi-Energy Summary

### BATCH 10: Deprecated OVOS Endpoints (4 endpoints) ‚ö†Ô∏è
36. `GET /api/v1/ovos/summary` - ‚ö†Ô∏è OVOS Factory Summary (deprecated)
37. `GET /api/v1/ovos/top-consumers` - ‚ö†Ô∏è OVOS Top Consumers (deprecated)
38. `GET /api/v1/ovos/machines/{machine_name}/status` - ‚ö†Ô∏è OVOS Machine Status (deprecated)
39. `GET /api/v1/ovos/forecast/tomorrow` - ‚ö†Ô∏è OVOS Forecast (deprecated)

### BATCH 11: Alerts & Subscriptions (1 endpoint)
40. `POST /api/v1/alerts/subscribe` - Subscribe to Alerts

### BATCH 12: ISO 50001 Compliance (4 endpoints)
41. `GET /api/v1/iso50001/enpi-report` - Energy Performance Indicators Report
42. `POST /api/v1/iso50001/action-plans` - Create Action Plan
43. `GET /api/v1/iso50001/action-plans` - List Action Plans
44. `PUT /api/v1/iso50001/action-plans/{id}/progress` - Update Action Plan Progress

**TOTAL: 44 UNIQUE API ENDPOINTS**

---

## üìã MASTER PROGRESS TRACKER

| Batch | # | Endpoint | Queries | Pass | Fail | % | Status |
|-------|---|----------|---------|------|------|---|--------|
| 1 | EP1 | GET /health | 5 | 5 | 0 | 100% | ‚úÖ Complete |
| 1 | EP2 | GET /stats/system | 8 | 8 | 0 | 100% | ‚úÖ Complete |
| 1 | EP3 | GET /stats/aggregated | 6 | 0 | 0 | 0% | ‚è≥ Not Started |
| 2 | EP4 | GET /machines | 8 | 0 | 0 | 0% | ‚è≥ Not Started |
| 2 | EP5 | GET /machines/{id} | 5 | 0 | 0 | 0% | ‚è≥ Not Started |
| 2 | EP6 | GET /machines/status/{name} ‚≠ê | 12 | 0 | 0 | 0% | ‚è≥ Not Started |
| 3 | EP9 | GET /timeseries/energy ‚≠ê | 10 | 0 | 0 | 0% | ‚è≥ Not Started |
| 3 | EP10 | GET /timeseries/power | 8 | 0 | 0 | 0% | ‚è≥ Not Started |
| 3 | EP11 | GET /timeseries/latest/{id} | 6 | 0 | 0 | 0% | ‚è≥ Not Started |
| 3 | EP12 | GET /timeseries/multi-machine | 7 | 0 | 0 | 0% | ‚è≥ Not Started |
| 4 | EP13 | POST /anomaly/detect | 8 | 0 | 0 | 0% | ‚è≥ Not Started |
| 4 | EP14 | GET /anomaly/recent | 8 | 0 | 0 | 0% | ‚è≥ Not Started |
| 4 | EP15 | GET /anomaly/active | 5 | 0 | 0 | 0% | ‚è≥ Not Started |
| 4 | EP16 | GET /anomaly/search | 7 | 0 | 0 | 0% | ‚è≥ Not Started |
| 5 | EP17 | GET /baseline/models | 8 | 0 | 0 | 0% | ‚è≥ Not Started |
| 5 | EP18 | POST /baseline/predict ‚≠ê | 12 | 0 | 0 | 0% | ‚è≥ Not Started |
| 5 | EP19 | GET /baseline/model/{id} | 6 | 0 | 0 | 0% | ‚è≥ Not Started |
| 5 | EP20 | POST /baseline/train-seu | 5 | 0 | 0 | 0% | ‚è≥ Not Started |
| 6 | EP21 | GET /kpi/all | 6 | 0 | 0 | 0% | ‚è≥ Not Started |
| 6 | EP22 | GET /kpi/energy-cost | 7 | 0 | 0 | 0% | ‚è≥ Not Started |
| 6 | EP23 | POST /performance/analyze | 8 | 0 | 0 | 0% | ‚è≥ Not Started |
| 6 | EP24 | GET /performance/health | 4 | 0 | 0 | 0% | ‚è≥ Not Started |
| 6 | EP25 | GET /performance/opportunities | 6 | 0 | 0 | 0% | ‚è≥ Not Started |
| 6 | EP26 | POST /performance/action-plan | 5 | 0 | 0 | 0% | ‚è≥ Not Started |
| 7 | EP27 | GET /forecast/short-term | 10 | 0 | 0 | 0% | ‚è≥ Not Started |
| 7 | EP28 | GET /forecast/demand | 6 | 0 | 0 | 0% | ‚è≥ Not Started |
| 8 | EP29 | GET /seus | 5 | 0 | 0 | 0% | ‚è≥ Not Started |
| 8 | EP30 | GET /factory/summary | 8 | 0 | 0 | 0% | ‚è≥ Not Started |
| 8 | EP31 | GET /analytics/top-consumers ‚≠ê | 12 | 0 | 0 | 0% | ‚è≥ Not Started |
| 9 | EP33 | GET /{id}/energy-types | 5 | 0 | 0 | 0% | ‚è≥ Not Started |
| 9 | EP34 | GET /{id}/energy/{type} | 8 | 0 | 0 | 0% | ‚è≥ Not Started |
| 9 | EP35 | GET /{id}/energy-summary | 7 | 0 | 0 | 0% | ‚è≥ Not Started |
| 10 | EP36 | GET /ovos/summary ‚ö†Ô∏è | 5 | 0 | 0 | 0% | ‚è≥ Not Started |
| 10 | EP37 | GET /ovos/top-consumers ‚ö†Ô∏è | 6 | 0 | 0 | 0% | ‚è≥ Not Started |
| 10 | EP38 | GET /ovos/machines/{name}/status ‚ö†Ô∏è | 6 | 0 | 0 | 0% | ‚è≥ Not Started |
| 10 | EP39 | GET /ovos/forecast/tomorrow ‚ö†Ô∏è | 5 | 0 | 0 | 0% | ‚è≥ Not Started |
| 11 | EP40 | POST /alerts/subscribe | 6 | 0 | 0 | 0% | ‚è≥ Not Started |
| 12 | EP41 | GET /iso50001/enpi-report | 6 | 0 | 0 | 0% | ‚è≥ Not Started |
| 12 | EP42 | POST /iso50001/action-plans | 5 | 0 | 0 | 0% | ‚è≥ Not Started |
| 12 | EP43 | GET /iso50001/action-plans | 6 | 0 | 0 | 0% | ‚è≥ Not Started |
| 12 | EP44 | PUT /iso50001/action-plans/{id} | 5 | 0 | 0 | 0% | ‚è≥ Not Started |
| **TOTAL** | **41** | **ALL ENDPOINTS** | **~300** | **0** | **0** | **0%** | ‚è≥ **Not Started** |

**Legend:**
- ‚≠ê = Critical endpoint (most used)
- ‚ö†Ô∏è = Deprecated (still active but not recommended)
- ‚è≥ = Not Started
- üîÑ = In Progress
- ‚úÖ = Complete (all queries PASS)
- ‚ùå = Has Failures (fix needed)

---

## üß™ BATCH 1: CORE SYSTEM HEALTH

---

### EP1: Health Check

**API Endpoint:** `GET /api/v1/health`  
**Parameters:** None  
**Purpose:** Check if EnMS Analytics service is running  
**Expected Response:** Service status, database connection, active machines count

---

#### Query 1.1: Basic health check

**OVOS Query:** `"Is the energy system online?"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/health | jq '.'
```

**Expected curl Output:**
```json
{
  "service": "EnMS Analytics Service",
  "version": "1.0.0",
  "status": "healthy",
  "database": {"status": "connected"},
  "scheduler": {"enabled": true, "running": true},
  "active_machines": 8,
  "baseline_models": 61
}
```

**Run Test:**
1. Terminal 1: `journalctl -u ovos-core -f | grep -E "intent|api|endpoint"`
2. Terminal 2: Run curl above ‚Üí Save output to `/tmp/ep1_q1_curl.json`
3. Terminal 3: Say/type: "Is the energy system online?"
4. Check logs: Intent, API called, params
5. Compare: curl output vs OVOS response

**Actual Results:**
- curl Output: `{"status": "healthy", "active_machines": 8, "baseline_models": 286, ...}`
- OVOS Response: `"Yes, the energy management system is online and healthy. 8 machines are currently active with 286 trained baseline models."`
- Intent Classified: `factory_overview`
- API Called: `GET /api/v1/health`
- Params Sent: None
- Template Used: `health_check.dialog`

**Verification Checklist:**
- [x] Intent: FACTORY_OVERVIEW ‚úÖ
- [x] API: `GET /api/v1/health` ‚úÖ
- [x] Params: None ‚úÖ
- [x] Response: Mentions "system" "healthy" and "8 machines active" ‚úÖ
- [x] Voice-friendly: Yes/no answer with brief status ‚úÖ

**Status:** ‚úÖ PASS  
**Issues:** None  
**Fix Applied:** N/A

---

#### Query 1.2: System diagnostics

**OVOS Query:** `"Check system health"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/health | jq '.'
```

**Actual Results:**
- curl Output: `{Same as 1.1}`
- OVOS Response: `{TBD}`

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] API: `/health`
- [ ] Reports active machines count
- [ ] Reports baseline models count

**Status:** ‚è≥ NOT TESTED

---

#### Query 1.3: Service status

**OVOS Query:** `"What's the status of the analytics service?"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/health | jq '.'
```

**Verification:**
- [ ] Intent classified correctly
- [ ] API: `/health`
- [ ] Mentions service status or database status

**Status:** ‚è≥ NOT TESTED

---

#### Query 1.4: Database connection check

**OVOS Query:** `"Is the database connected?"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/health | jq '.database'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW or HEALTH
- [ ] API: `/health`
- [ ] Reports database.status
- [ ] Voice: "Yes, database is connected" or similar

**Status:** ‚è≥ NOT TESTED

---

#### Query 1.5: How many machines active

**OVOS Query:** `"How many machines are active?"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/health | jq '.active_machines'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] API: `/health` (or could be `/stats/system`)
- [ ] Reports active_machines count
- [ ] Voice: "8 machines are currently active"

**Status:** ‚è≥ NOT TESTED

---

### EP2: System Statistics

**API Endpoint:** `GET /api/v1/stats/system`  
**Parameters:** None  
**Purpose:** Get real-time energy metrics across all machines

---

#### Query 2.1: Total energy today

**OVOS Query:** `"How much energy are we using today?"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/stats/system | jq '.'
```

**Expected curl Output:**
```json
{
  "total_energy": 92484,
  "energy_per_hour": 680,
  "peak_power": 2249,
  "avg_power": 58,
  "estimated_cost": 11098.08,
  "cost_per_day": 1957.06,
  "carbon_footprint": 46242.0,
  "active_machines_today": 8
}
```

**Actual Results:**
- curl Output: `{"total_energy": 164026, "energy_per_hour": 200, "peak_power": 2249, "avg_power": 140, ...}`
- OVOS Response: `"The factory has consumed 164026 kilowatt hours total. Current rate is 200 kilowatt hours per hour."`
- Intent Classified: `ENERGY_QUERY`
- API Called: `GET /api/v1/stats/system`
- Template Used: `energy_query.dialog`

**Verification:**
- [x] Intent: ENERGY_QUERY ‚úÖ
- [x] API: `/stats/system` ‚úÖ
- [x] Reports total_energy (164026) and energy_per_hour (200) ‚úÖ
- [x] Voice-friendly: "The factory has consumed 164026 kilowatt hours total. Current rate is 200 kilowatt hours per hour." ‚úÖ

**Status:** ‚úÖ PASS

---

#### Query 2.2: Current power consumption

**OVOS Query:** `"What's our current power consumption?"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/stats/system | jq '{peak_power, avg_power}'
```

**Actual Results:**
- curl Output: `{"peak_power": 2249, "avg_power": 140}`
- OVOS Response: `"Current power consumption is 140 kilowatts average, with a peak of 2249 kilowatts."`
- Intent Classified: `POWER_QUERY`
- API Called: `GET /api/v1/stats/system`
- Template Used: `power_query.dialog`

**Verification:**
- [x] Intent: POWER_QUERY ‚úÖ
- [x] API: `/stats/system` ‚úÖ
- [x] Reports peak_power (2249) and avg_power (140) ‚úÖ
- [x] Voice: "Current power consumption is 140 kilowatts average, with a peak of 2249 kilowatts." ‚úÖ

**Status:** ‚úÖ PASS (BUG FIXED: Updated power_query.dialog)

---

#### Query 2.3: Energy cost

**OVOS Query:** `"How much is energy costing us?"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/stats/system | jq '{estimated_cost, cost_per_day}'
```

**Actual Results:**
- curl Output: `{"estimated_cost": 19683.12, "cost_per_day": 575.2}`
- OVOS Response: Comprehensive factory overview including energy, cost ($19683.12), and carbon (82013 kg)
- Intent Classified: `FACTORY_OVERVIEW`
- API Called: `GET /api/v1/stats/system`
- Template Used: `factory_overview.dialog`

**Verification:**
- [x] Intent: FACTORY_OVERVIEW ‚úÖ
- [x] API: `/stats/system` ‚úÖ
- [x] Reports estimated_cost ($19683.12) and carbon (82013 kg) ‚úÖ
- [x] Voice: Factory overview includes energy, cost, and carbon data ‚úÖ

**Status:** ‚úÖ PASS (BUG FIXED: Updated factory_overview.dialog)

---

#### Query 2.4: Carbon footprint

**OVOS Query:** `"What's our carbon footprint?"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/stats/system | jq '.carbon_footprint'
```

**Actual Results:**
- curl Output: `{"carbon_footprint": 82013}`
- OVOS Response: Comprehensive factory stats including energy, cost, and carbon footprint (82013 kg)
- Intent Classified: `FACTORY_OVERVIEW`
- API Called: `GET /api/v1/stats/system`
- Template Used: `factory_overview.dialog`

**Verification:**
- [x] Intent: FACTORY_OVERVIEW ‚úÖ
- [x] API: `/stats/system` ‚úÖ
- [x] Reports carbon_footprint (82013 kg) ‚úÖ
- [x] Voice: Comprehensive factory stats including carbon ‚úÖ

**Status:** ‚úÖ PASS

---

#### Query 2.5: Factory overview

**OVOS Query:** `"Give me a factory overview"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/stats/system | jq '.'
```

**Actual Results:**
- curl Output: `{"total_energy": 164026, "estimated_cost": 19683.12, "carbon_footprint": 82013, ...}`
- OVOS Response: Comprehensive multi-metric summary with energy, cost, and carbon data
- Intent Classified: `FACTORY_OVERVIEW` (heuristic tier)
- API Called: `GET /api/v1/stats/system`
- Template Used: `factory_overview.dialog`

**Verification:**
- [x] Intent: FACTORY_OVERVIEW (heuristic tier) ‚úÖ
- [x] API: `/stats/system` ‚úÖ
- [x] Comprehensive summary with energy (164026), cost ($19683.12), carbon (82013) ‚úÖ
- [x] Voice-friendly response with multiple metrics ‚úÖ

**Status:** ‚úÖ PASS

---

#### Query 2.6: Daily cost rate

**OVOS Query:** `"What's our daily energy cost?"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/stats/system | jq '.cost_per_day'
```

**Actual Results:**
- curl Output: `{"cost_per_day": 575.2, "estimated_cost": 19683.12}`
- OVOS Response: `"Total energy cost is $19683.12. Daily cost rate is $575.2."`
- Intent Classified: `COST_ANALYSIS`
- API Called: `GET /api/v1/stats/system`
- Template Used: `cost_analysis.dialog` (newly created)

**Verification:**
- [x] Intent: COST_ANALYSIS ‚úÖ
- [x] API: `/stats/system` ‚úÖ
- [x] Reports estimated_cost ($19683.12) and cost_per_day ($575.2) ‚úÖ
- [x] Voice: "Total energy cost is $19683.12. Daily cost rate is $575.2." ‚úÖ

**Status:** ‚úÖ PASS (BUG FIXED: Created cost_analysis.dialog + updated test_skill_logic.py)

---

#### Query 2.7: Peak power

**OVOS Query:** `"What was the peak power today?"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/stats/system | jq '.peak_power'
```

**Verification:**
- [x] Intent: POWER_QUERY ‚úÖ
- [x] API: `/stats/system` ‚úÖ
- [x] Reports peak_power (2249 kW) ‚úÖ
- [x] Voice: "Current power consumption is 140 kilowatts average, with a peak of 2249 kilowatts." ‚úÖ

**Status:** ‚úÖ PASS

---

#### Query 2.8: Average power

**OVOS Query:** `"What's the average power consumption?"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/stats/system | jq '.avg_power'
```

**Verification:**
- [x] Intent: POWER_QUERY ‚úÖ
- [x] API: `/stats/system` ‚úÖ
- [x] Reports avg_power (140 kW) ‚úÖ
- [x] Voice: "Current power consumption is 140 kilowatts average, with a peak of 2249 kilowatts." ‚úÖ

**Status:** ‚úÖ PASS

---

### EP3: Aggregated Statistics

**API Endpoint:** `GET /api/v1/stats/aggregated`  
**Parameters:** Optional: `start_time`, `end_time`  
**Purpose:** Get aggregated statistics with time ranges

---

#### Query 3.1: Aggregated stats (no time range)

**OVOS Query:** `"Show me aggregated statistics"`

**curl Command:**
```bash
curl -s http://10.33.10.109:8001/api/v1/stats/aggregated | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] API: `/stats/aggregated`
- [ ] No time params
- [ ] Comprehensive stats

**Status:** ‚è≥ NOT TESTED

---

#### Query 3.2: This week aggregated

**OVOS Query:** `"What are the aggregated stats for this week?"`

**curl Command:**
```bash
curl -G http://10.33.10.109:8001/api/v1/stats/aggregated \
  --data-urlencode "start_time=$(date -u -d '7 days ago' +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] API: `/stats/aggregated`
- [ ] Params: start_time (7 days ago), end_time (now)
- [ ] Weekly aggregate data

**Status:** ‚è≥ NOT TESTED

---

#### Query 3.3: Last month aggregated

**OVOS Query:** `"Show aggregated stats for last month"`

**curl Command:**
```bash
curl -G http://10.33.10.109:8001/api/v1/stats/aggregated \
  --data-urlencode "start_time=$(date -u -d '1 month ago' +%Y-%m-01T00:00:00Z)" \
  --data-urlencode "end_time=$(date -u -d '1 month ago' +%Y-%m-%dT23:59:59Z)" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] API: `/stats/aggregated`
- [ ] Params: last month's start and end
- [ ] Monthly aggregate

**Status:** ‚è≥ NOT TESTED

---

#### Query 3.4: Today aggregated

**OVOS Query:** `"Aggregated stats for today"`

**curl Command:**
```bash
curl -G http://10.33.10.109:8001/api/v1/stats/aggregated \
  --data-urlencode "start_time=$(date -u +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] API: `/stats/aggregated`
- [ ] Params: today's date
- [ ] Daily aggregate

**Status:** ‚è≥ NOT TESTED

---

#### Query 3.5-3.6: Additional aggregated tests

**Status:** ‚è≥ NOT TESTED

---

## üß™ BATCH 2: MACHINE DISCOVERY & INFO

---

### EP4: List/Search Machines

**API Endpoint:** `GET /api/v1/machines`  
**Parameters:** Optional: `search`, `is_active`  
**Purpose:** Get all machines with optional filtering

---

#### Query 4.1: List all machines

**OVOS Query:** `"List all machines"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] API: `/machines` (no params)
- [ ] Lists all 8 machines
- [ ] Voice-friendly listing

**Status:** ‚è≥ NOT TESTED

---

#### Query 4.2: List active machines

**OVOS Query:** `"Show me active machines"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines?is_active=true" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] API: `/machines`
- [ ] Param: is_active=true
- [ ] Only active machines

**Status:** ‚è≥ NOT TESTED

---

#### Query 4.3: Search compressor

**OVOS Query:** `"Find the compressor"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines?search=compressor" | jq '.'
```

**Verification:**
- [ ] Intent: MACHINE_STATUS or FACTORY_OVERVIEW
- [ ] API: `/machines`
- [ ] Param: search=compressor
- [ ] Returns Compressor-1, Compressor-EU-1

**Status:** ‚è≥ NOT TESTED

---

#### Query 4.4: Search HVAC

**OVOS Query:** `"Which HVAC units do we have?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines?search=hvac" | jq '.'
```

**Verification:**
- [ ] Intent: MACHINE_STATUS
- [ ] Param: search=hvac
- [ ] Returns HVAC-Main, HVAC-EU-North

**Status:** ‚è≥ NOT TESTED

---

#### Query 4.5: Combined filter

**OVOS Query:** `"Show me active HVAC machines"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines?search=hvac&is_active=true" | jq '.'
```

**Verification:**
- [ ] Intent: MACHINE_STATUS
- [ ] Both params: search=hvac, is_active=true
- [ ] Correct filtering

**Status:** ‚è≥ NOT TESTED

---

#### Query 4.6: No results

**OVOS Query:** `"Find the turbine machine"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines?search=turbine" | jq '.'
```

**Verification:**
- [ ] Intent: MACHINE_STATUS
- [ ] Param: search=turbine
- [ ] Result: Empty array []
- [ ] Voice: "No machines found"

**Status:** ‚è≥ NOT TESTED

---

#### Query 4.7-4.8: Additional search tests

**Status:** ‚è≥ NOT TESTED

---

### EP5: Get Machine by ID

**API Endpoint:** `GET /api/v1/machines/{machine_id}`  
**Parameters:** `machine_id` (in path)  
**Purpose:** Get detailed information about a specific machine by UUID

---

#### Query 5.1: Get Compressor-1 by ID

**OVOS Query:** `"Get details for machine ID [UUID]"` (Internal/Debug use)

**curl Command:**
```bash
# First get ID
ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')
# Then get details
curl -s "http://10.33.10.109:8001/api/v1/machines/$ID" | jq '.'
```

**Verification:**
- [ ] Intent: MACHINE_STATUS (likely via name, but testing ID lookup)
- [ ] API: `/machines/{id}`
- [ ] Returns full machine details
- [ ] Factory location included

**Status:** ‚è≥ NOT TESTED

---

#### Query 5.2: Get Boiler-1 by ID

**OVOS Query:** `"Show info for Boiler-1"` (Should resolve ID internally)

**curl Command:**
```bash
ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Boiler-1" | jq -r '.[0].id')
curl -s "http://10.33.10.109:8001/api/v1/machines/$ID" | jq '.'
```

**Verification:**
- [ ] Intent: MACHINE_STATUS
- [ ] API: `/machines/{id}`
- [ ] Correct machine returned

**Status:** ‚è≥ NOT TESTED

---

#### Query 5.3: Invalid ID handling

**OVOS Query:** N/A (API Test)

**curl Command:**
```bash
curl -s -w "%{http_code}" "http://10.33.10.109:8001/api/v1/machines/00000000-0000-0000-0000-000000000000"
```

**Verification:**
- [ ] Returns 404 Not Found
- [ ] Error message structure

**Status:** ‚è≥ NOT TESTED

---

### EP6: Machine Status by Name ‚≠ê CRITICAL

**API Endpoint:** `GET /api/v1/machines/status/{machine_name}`  
**Parameters:** `machine_name` (in path)  
**Purpose:** Get comprehensive machine status by name (most used endpoint!)

---

#### Query 6.1: Basic status - Compressor-1

**OVOS Query:** `"What's the status of Compressor-1?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines/status/Compressor-1" | jq '.'
```

**Expected curl Output:**
```json
{
  "machine_id": "c0000000-0000-0000-0000-000000000001",
  "machine_name": "Compressor-1",
  "is_active": true,
  "current_status": {
    "status": "running",
    "power_kw": 46.22,
    "last_reading": "2025-11-06T07:46:14+00:00"
  },
  "today_stats": {
    "energy_kwh": 344.66,
    "cost_usd": 51.7,
    "avg_power_kw": 44.41,
    "peak_power_kw": 54.85,
    "uptime_hours": 7.76
  },
  "recent_anomalies": {"count": 0, "critical": 0, "warnings": 0},
  "production_today": {"units_produced": 5987460, "quality_percent": 100.0}
}
```

**Verification:**
- [ ] Intent: MACHINE_STATUS
- [ ] API: `/machines/status/Compressor-1`
- [ ] Machine extracted: Compressor-1
- [ ] Comprehensive status (running/idle/stopped, power, energy, cost)

**Status:** ‚è≥ NOT TESTED

---

#### Query 6.2: Is machine running

**OVOS Query:** `"Is Compressor-1 running?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines/status/Compressor-1" | jq '.current_status.status'
```

**Verification:**
- [ ] Intent: MACHINE_STATUS
- [ ] API: `/machines/status/Compressor-1`
- [ ] Reports current_status.status
- [ ] Voice: "Yes, running" / "No, idle" / "No, stopped"

**Status:** ‚è≥ NOT TESTED

---

#### Query 6.3: Current power - HVAC

**OVOS Query:** `"What's the current power of HVAC-Main?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines/status/HVAC-Main" | jq '.current_status.power_kw'
```

**Verification:**
- [ ] Intent: POWER_QUERY
- [ ] API: `/machines/status/HVAC-Main`
- [ ] Reports current_status.power_kw
- [ ] Units: kilowatts

**Status:** ‚è≥ NOT TESTED

---

#### Query 6.4: Today's energy

**OVOS Query:** `"How much energy did Compressor-1 use today?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines/status/Compressor-1" | jq '.today_stats.energy_kwh'
```

**Verification:**
- [ ] Intent: ENERGY_QUERY
- [ ] API: `/machines/status/Compressor-1`
- [ ] Reports today_stats.energy_kwh
- [ ] Units: kWh

**Status:** ‚è≥ NOT TESTED

---

#### Query 6.5: Cost today

**OVOS Query:** `"What's the cost for HVAC-Main today?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines/status/HVAC-Main" | jq '.today_stats.cost_usd'
```

**Verification:**
- [ ] Intent: COST_ANALYSIS
- [ ] Reports today_stats.cost_usd
- [ ] Currency: dollars

**Status:** ‚è≥ NOT TESTED

---

#### Query 6.6: Anomaly check

**OVOS Query:** `"Are there anomalies on Compressor-1?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines/status/Compressor-1" | jq '.recent_anomalies'
```

**Verification:**
- [ ] Intent: ANOMALY_DETECTION
- [ ] Reports recent_anomalies.count
- [ ] Reports severity (critical, warnings)

**Status:** ‚è≥ NOT TESTED

---

#### Query 6.7: Production units

**OVOS Query:** `"How many units did Compressor-1 produce today?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines/status/Compressor-1" | jq '.production_today.units_produced'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW or PRODUCTION
- [ ] Reports production_today.units_produced
- [ ] Voice: "5.9 million units"

**Status:** ‚è≥ NOT TESTED

---

#### Query 6.8: Quality rate

**OVOS Query:** `"What's the quality rate for Compressor-1?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines/status/Compressor-1" | jq '.production_today.quality_percent'
```

**Verification:**
- [ ] Reports production_today.quality_percent
- [ ] Percentage format

**Status:** ‚è≥ NOT TESTED

---

#### Query 6.9: Peak power today

**OVOS Query:** `"What was the peak power for Compressor-1 today?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines/status/Compressor-1" | jq '.today_stats.peak_power_kw'
```

**Verification:**
- [ ] Intent: POWER_QUERY
- [ ] Reports today_stats.peak_power_kw

**Status:** ‚è≥ NOT TESTED

---

#### Query 6.10: Uptime

**OVOS Query:** `"How long has Compressor-1 been running today?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/machines/status/Compressor-1" | jq '.today_stats.uptime_hours'
```

**Verification:**
- [ ] Intent: MACHINE_STATUS
- [ ] Reports today_stats.uptime_hours
- [ ] Voice: "7 hours and 45 minutes"

**Status:** ‚è≥ NOT TESTED

---

#### Query 6.11-6.12: Additional machine status tests

**Status:** ‚è≥ NOT TESTED

---

## üß™ BATCH 3: TIME-SERIES DATA

---

### EP9: Energy Time-Series ‚≠ê CRITICAL - FAILING

**API Endpoint:** `GET /api/v1/timeseries/energy`  
**Parameters:** `machine_id`, `start_time`, `end_time`, `interval`  
**Purpose:** Get aggregated energy consumption with time intervals

---

#### Query 9.1: This week energy - HVAC-Main (KNOWN FAILING)

**OVOS Query:** `"What's the energy efficiency for HVAC-Main this week?"`

**NOTE:** Query asks for "efficiency" but should return energy consumption time-series

**curl Command:**
```bash
# Get machine ID
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=HVAC-Main" | jq -r '.[0].id')

# Get weekly energy data
curl -G "http://10.33.10.109:8001/api/v1/timeseries/energy" \
  --data-urlencode "machine_id=$MACHINE_ID" \
  --data-urlencode "start_time=$(date -u -d '7 days ago' +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" \
  --data-urlencode "interval=1day" | jq '.'
```

**Expected curl Output:**
```json
{
  "machine_id": "...",
  "machine_name": "HVAC-Main",
  "metric": "energy",
  "interval": "1day",
  "data_points": [
    {"timestamp": "2025-11-13T00:00:00Z", "value": 480.5, "unit": "kWh"},
    {"timestamp": "2025-11-14T00:00:00Z", "value": 492.1, "unit": "kWh"},
    ...
  ]
}
```

**Verification:**
- [ ] Intent: ENERGY_QUERY (or custom EFFICIENCY)
- [ ] **CRITICAL:** API must be `/timeseries/energy` NOT `/machines/status`
- [ ] Machine: HVAC-Main extracted
- [ ] Time range: this week (7 days)
- [ ] Interval: 1day
- [ ] Response: Daily breakdown OR total kWh
- [ ] **ISSUE:** Does OVOS calculate efficiency (kWh/units) or just report energy?

**Status:** ‚è≥ NOT TESTED | Expected: ‚ùå FAIL

**Known Issue:** Currently calls `/machines/status` and returns TODAY's energy, not week-long time-series

---

#### Query 9.2: Today hourly energy

**OVOS Query:** `"Show hourly energy consumption for Compressor-1 today"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')

curl -G "http://10.33.10.109:8001/api/v1/timeseries/energy" \
  --data-urlencode "machine_id=$MACHINE_ID" \
  --data-urlencode "start_time=$(date -u +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" \
  --data-urlencode "interval=1hour" | jq '.'
```

**Verification:**
- [ ] Intent: ENERGY_QUERY
- [ ] API: `/timeseries/energy`
- [ ] Machine: Compressor-1
- [ ] Time: today 00:00 to now
- [ ] Interval: 1hour
- [ ] Response: Hourly breakdown (array of data_points)

**Status:** ‚è≥ NOT TESTED

---

#### Query 9.3: Yesterday's energy

**OVOS Query:** `"How much energy did the HVAC use yesterday?"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=HVAC" | jq -r '.[0].id')

curl -G "http://10.33.10.109:8001/api/v1/timeseries/energy" \
  --data-urlencode "machine_id=$MACHINE_ID" \
  --data-urlencode "start_time=$(date -u -d 'yesterday' +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_time=$(date -u -d 'yesterday' +%Y-%m-%dT23:59:59Z)" \
  --data-urlencode "interval=1day" | jq '.'
```

**Verification:**
- [ ] Intent: ENERGY_QUERY
- [ ] Machine: HVAC (partial match ok)
- [ ] Time: yesterday full day
- [ ] Total kWh reported

**Status:** ‚è≥ NOT TESTED

---

#### Query 9.4: Last hour 15-min data

**OVOS Query:** `"Give me 15-minute energy data for Compressor-1 in the last hour"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')

curl -G "http://10.33.10.109:8001/api/v1/timeseries/energy" \
  --data-urlencode "machine_id=$MACHINE_ID" \
  --data-urlencode "start_time=$(date -u -d '1 hour ago' +%Y-%m-%dT%H:%M:%SZ)" \
  --data-urlencode "end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" \
  --data-urlencode "interval=15min" | jq '.'
```

**Verification:**
- [ ] Intent: ENERGY_QUERY
- [ ] Interval: 15min (4 data points)

**Status:** ‚è≥ NOT TESTED

---

#### Query 9.5: Last 24 hours

**OVOS Query:** `"Compressor-1 energy consumption last 24 hours"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')

curl -G "http://10.33.10.109:8001/api/v1/timeseries/energy" \
  --data-urlencode "machine_id=$MACHINE_ID" \
  --data-urlencode "start_time=$(date -u -d '24 hours ago' +%Y-%m-%dT%H:%M:%SZ)" \
  --data-urlencode "end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" \
  --data-urlencode "interval=1hour" | jq '.'
```

**Verification:**
- [ ] Interval: 1hour (24 data points)
- [ ] Total kWh calculated

**Status:** ‚è≥ NOT TESTED

---

#### Query 9.6-9.10: Additional time-series tests (This month, Last week, Custom ranges, Different intervals)

**Status:** ‚è≥ NOT TESTED

---

### EP10: Power Time-Series

**API Endpoint:** `GET /api/v1/timeseries/power`  
**Parameters:** `machine_id`, `start_time`, `end_time`, `interval`  
**Purpose:** Get average power demand (kW) over time

---

#### Query 10.1: Average power today

**OVOS Query:** `"What was the average power demand today?"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')

curl -G "http://10.33.10.109:8001/api/v1/timeseries/power" \
  --data-urlencode "machine_id=$MACHINE_ID" \
  --data-urlencode "start_time=$(date -u +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" \
  --data-urlencode "interval=1hour" | jq '.'
```

**Verification:**
- [ ] Intent: POWER_QUERY
- [ ] API: `/timeseries/power`
- [ ] Metric: power (kW)
- [ ] Aggregation: average

**Status:** ‚è≥ NOT TESTED

---

#### Query 10.2: Power trend last hour

**OVOS Query:** `"Show me power consumption pattern for last hour"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')

curl -G "http://10.33.10.109:8001/api/v1/timeseries/power" \
  --data-urlencode "machine_id=$MACHINE_ID" \
  --data-urlencode "start_time=$(date -u -d '1 hour ago' +%Y-%m-%dT%H:%M:%SZ)" \
  --data-urlencode "end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" \
  --data-urlencode "interval=5min" | jq '.'
```

**Verification:**
- [ ] Interval: 5min (high resolution)
- [ ] Trend analysis

**Status:** ‚è≥ NOT TESTED

---

### EP11: Latest Reading

**API Endpoint:** `GET /api/v1/timeseries/latest/{machine_id}`  
**Parameters:** `machine_id` (in path)  
**Purpose:** Get the most recent sensor reading

---

#### Query 11.1: Current power consumption

**OVOS Query:** `"What's the current power of Compressor-1?"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')
curl -s "http://10.33.10.109:8001/api/v1/timeseries/latest/$MACHINE_ID" | jq '.'
```

**Verification:**
- [ ] Intent: POWER_QUERY
- [ ] API: `/timeseries/latest/{id}`
- [ ] Returns single object (not array)
- [ ] Real-time data

**Status:** ‚è≥ NOT TESTED

---

#### Query 11.2: Is machine running?

**OVOS Query:** `"Is the HVAC running right now?"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=HVAC" | jq -r '.[0].id')
curl -s "http://10.33.10.109:8001/api/v1/timeseries/latest/$MACHINE_ID" | jq '.status'
```

**Verification:**
- [ ] Intent: MACHINE_STATUS
- [ ] Checks status field ("running", "idle", "stopped")

**Status:** ‚è≥ NOT TESTED

---

### EP12: Multi-Machine Comparison

**API Endpoint:** `GET /api/v1/timeseries/multi-machine/energy`  
**Parameters:** `machine_ids`, `start_time`, `end_time`, `interval`  
**Purpose:** Compare energy consumption across machines

---

#### Query 12.1: Compare two machines

**OVOS Query:** `"Compare energy usage between Compressor-1 and HVAC-Main"`

**curl Command:**
```bash
ID1=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')
ID2=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=HVAC-Main" | jq -r '.[0].id')

curl -G "http://10.33.10.109:8001/api/v1/timeseries/multi-machine/energy" \
  --data-urlencode "machine_ids=$ID1,$ID2" \
  --data-urlencode "start_time=$(date -u +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" \
  --data-urlencode "interval=1hour" | jq '.'
```

**Verification:**
- [ ] Intent: COMPARISON
- [ ] API: `/timeseries/multi-machine/energy`
- [ ] Returns data for both machines
- [ ] Synchronized timestamps

**Status:** ‚è≥ NOT TESTED

---

#### Query 12.2: Compare all compressors

**OVOS Query:** `"Compare all compressors this week"`

**curl Command:**
```bash
# Get all compressor IDs (simulated with 2 known ones for test)
ID1=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')
ID2=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-EU" | jq -r '.[0].id')

curl -G "http://10.33.10.109:8001/api/v1/timeseries/multi-machine/energy" \
  --data-urlencode "machine_ids=$ID1,$ID2" \
  --data-urlencode "start_time=$(date -u -d '7 days ago' +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" \
  --data-urlencode "interval=1day" | jq '.'
```

**Verification:**
- [ ] Intent: COMPARISON
- [ ] Group comparison
- [ ] Weekly data

**Status:** ‚è≥ NOT TESTED

---

## üß™ BATCH 4: ANOMALY DETECTION

---

### EP13: Detect Anomalies

**API Endpoint:** `POST /api/v1/anomaly/detect`  
**Parameters:** `machine_id`, `start`, `end`, `contamination`, `use_baseline`  
**Purpose:** Run ML anomaly detection on machine data

---

#### Query 13.1: Detect anomalies today - Compressor-1

**OVOS Query:** `"Check for anomalies in Compressor-1 today"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')

curl -X POST "http://10.33.10.109:8001/api/v1/anomaly/detect" \
  -H "Content-Type: application/json" \
  -d "{
    \"machine_id\": \"$MACHINE_ID\",
    \"start\": \"$(date -u +%Y-%m-%dT00:00:00Z)\",
    \"end\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\"
  }" | jq '.'
```

**Verification:**
- [ ] Intent: ANOMALY_DETECTION
- [ ] API: `POST /anomaly/detect`
- [ ] Machine: Compressor-1
- [ ] Time: today
- [ ] Reports: anomalies_detected count, severity

**Status:** ‚è≥ NOT TESTED

---

#### Query 13.2: Detect last hour anomalies

**OVOS Query:** `"Detect unusual patterns in last hour"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=HVAC-Main" | jq -r '.[0].id')

curl -X POST "http://10.33.10.109:8001/api/v1/anomaly/detect" \
  -H "Content-Type: application/json" \
  -d "{
    \"machine_id\": \"$MACHINE_ID\",
    \"start\": \"$(date -u -d '1 hour ago' +%Y-%m-%dT%H:%M:%SZ)\",
    \"end\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\"
  }" | jq '.'
```

**Verification:**
- [ ] Intent: ANOMALY_DETECTION
- [ ] Time: last 1 hour
- [ ] ML model used (baseline_model_version)

**Status:** ‚è≥ NOT TESTED

---

#### Query 13.3: Custom contamination rate

**OVOS Query:** `"Run anomaly detection on HVAC with high sensitivity"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=HVAC" | jq -r '.[0].id')

curl -X POST "http://10.33.10.109:8001/api/v1/anomaly/detect" \
  -H "Content-Type: application/json" \
  -d "{
    \"machine_id\": \"$MACHINE_ID\",
    \"start\": \"$(date -u +%Y-%m-%dT00:00:00Z)\",
    \"end\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\",
    \"contamination\": 0.05
  }" | jq '.'
```

**Verification:**
- [ ] Contamination: 0.05 (5% sensitivity)
- [ ] More sensitive detection

**Status:** ‚è≥ NOT TESTED

---

#### Query 13.4-13.8: Additional detection tests (Yesterday, This week, Different machines, No baseline case, Confidence scores)

**Status:** ‚è≥ NOT TESTED

---

### EP14: Recent Anomalies

**API Endpoint:** `GET /api/v1/anomaly/recent`  
**Parameters:** `machine_id`, `severity`, `limit`, `start_time`, `end_time`  
**Purpose:** Get anomalies from last 7 days (default)

---

#### Query 14.1: All recent anomalies

**OVOS Query:** `"Show me recent anomalies"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/anomaly/recent?limit=10" | jq '.'
```

**Verification:**
- [ ] Intent: ANOMALY_DETECTION
- [ ] API: `/anomaly/recent`
- [ ] No filters (all machines)
- [ ] Last 7 days
- [ ] Reports total_count

**Status:** ‚è≥ NOT TESTED

---

#### Query 14.2: Critical issues today

**OVOS Query:** `"What critical issues happened today?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/anomaly/recent?severity=critical&start_time=$(date -u +%Y-%m-%dT00:00:00Z)&end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" | jq '.'
```

**Verification:**
- [ ] Intent: ANOMALY_DETECTION
- [ ] Severity: critical
- [ ] Time: today
- [ ] Voice: "X critical issues found" or "No critical issues"

**Status:** ‚è≥ NOT TESTED

---

#### Query 14.3: Anomalies for specific machine

**OVOS Query:** `"List anomalies for Compressor-1"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')

curl -s "http://10.33.10.109:8001/api/v1/anomaly/recent?machine_id=$MACHINE_ID" | jq '.'
```

**Verification:**
- [ ] Intent: ANOMALY_DETECTION
- [ ] Machine: Compressor-1
- [ ] Last 7 days
- [ ] Machine-specific anomalies

**Status:** ‚è≥ NOT TESTED

---

#### Query 14.4: Warning level anomalies

**OVOS Query:** `"Show warning level anomalies"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/anomaly/recent?severity=warning&limit=20" | jq '.'
```

**Verification:**
- [ ] Severity: warning
- [ ] Voice-friendly list

**Status:** ‚è≥ NOT TESTED

---

#### Query 14.5-14.8: Additional recent tests (This week, Last 24 hours, Multiple machines, Resolved vs unresolved)

**Status:** ‚è≥ NOT TESTED

---

### EP15: Active Anomalies

**API Endpoint:** `GET /api/v1/anomaly/active`  
**Parameters:** None  
**Purpose:** Get currently unresolved anomalies requiring attention

---

#### Query 15.1: Active alerts check

**OVOS Query:** `"Are there any active alerts?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/anomaly/active" | jq '.'
```

**Verification:**
- [ ] Intent: ANOMALY_DETECTION
- [ ] API: `/anomaly/active`
- [ ] Reports total_count
- [ ] Reports by_severity breakdown
- [ ] Voice: "X active alerts" with severity breakdown

**Status:** ‚è≥ NOT TESTED

---

#### Query 15.2: Unresolved issues

**OVOS Query:** `"Show me unresolved issues"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/anomaly/active" | jq '.'
```

**Verification:**
- [ ] Intent: ANOMALY_DETECTION
- [ ] Only unresolved anomalies (is_resolved=false)
- [ ] Sorted by severity

**Status:** ‚è≥ NOT TESTED

---

#### Query 15.3: Problems needing attention

**OVOS Query:** `"What problems need attention?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/anomaly/active" | jq '{total_count, by_severity, critical_items: [.anomalies[] | select(.severity=="critical")]}'
```

**Verification:**
- [ ] Intent: ANOMALY_DETECTION
- [ ] Highlights critical items first
- [ ] Actionable information

**Status:** ‚è≥ NOT TESTED

---

#### Query 15.4-15.5: Additional active tests (Count by machine, Oldest unresolved)

**Status:** ‚è≥ NOT TESTED

---

### EP16: Search Anomalies

**API Endpoint:** `GET /api/v1/anomaly/search`  
**Parameters:** `machine_id`, `start_date`, `end_date`, `severity`, `limit`  
**Purpose:** Search anomalies with date range and filters

---

#### Query 16.1: Search by date range

**OVOS Query:** `"Find anomalies from last month"`

**curl Command:**
```bash
curl -G "http://10.33.10.109:8001/api/v1/anomaly/search" \
  --data-urlencode "start_date=$(date -u -d '1 month ago' +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_date=$(date -u +%Y-%m-%dT%H:%M:%SZ)" \
  --data-urlencode "limit=50" | jq '.'
```

**Verification:**
- [ ] Intent: ANOMALY_DETECTION
- [ ] API: `/anomaly/search`
- [ ] Date range: last month
- [ ] Custom time range supported

**Status:** ‚è≥ NOT TESTED

---

#### Query 16.2: Search critical only

**OVOS Query:** `"Search for critical anomalies this week"`

**curl Command:**
```bash
curl -G "http://10.33.10.109:8001/api/v1/anomaly/search" \
  --data-urlencode "severity=critical" \
  --data-urlencode "start_date=$(date -u -d '7 days ago' +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_date=$(date -u +%Y-%m-%dT%H:%M:%SZ)" | jq '.'
```

**Verification:**
- [ ] Severity filter: critical
- [ ] Time: this week
- [ ] Only critical results

**Status:** ‚è≥ NOT TESTED

---

#### Query 16.3: Machine-specific search

**OVOS Query:** `"Search anomalies for Compressor-1 last week"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')

curl -G "http://10.33.10.109:8001/api/v1/anomaly/search" \
  --data-urlencode "machine_id=$MACHINE_ID" \
  --data-urlencode "start_date=$(date -u -d '7 days ago' +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_date=$(date -u +%Y-%m-%dT%H:%M:%SZ)" | jq '.'
```

**Verification:**
- [ ] Machine: Compressor-1
- [ ] Time: last week
- [ ] Machine + time filter

**Status:** ‚è≥ NOT TESTED

---

#### Query 16.4-16.7: Additional search tests (Custom limit, Multiple filters, Warning severity, Specific date)

**Status:** ‚è≥ NOT TESTED

---

## üß™ BATCH 5: BASELINE PREDICTION MODELS

---

### EP17: List Baseline Models

**API Endpoint:** `GET /api/v1/baseline/models`  
**Parameters:** `machine_id` OR `seu_name` + `energy_source`, `include_explanation`  
**Purpose:** Get trained ML baseline models for a machine

---

#### Query 17.1: List models by machine name

**OVOS Query:** `"Show baseline models for Compressor-1"`

**curl Command:**
```bash
curl -G "http://10.33.10.109:8001/api/v1/baseline/models" \
  --data-urlencode "seu_name=Compressor-1" \
  --data-urlencode "energy_source=electricity" | jq '.'
```

**Verification:**
- [ ] Intent: BASELINE or FACTORY_OVERVIEW
- [ ] API: `/baseline/models`
- [ ] SEU name: Compressor-1
- [ ] Lists all models for machine

**Status:** ‚è≥ NOT TESTED

---

#### Query 17.2: Models with explanations

**OVOS Query:** `"What baseline models exist for HVAC-Main?"`

**curl Command:**
```bash
curl -G "http://10.33.10.109:8001/api/v1/baseline/models" \
  --data-urlencode "seu_name=HVAC-Main" \
  --data-urlencode "energy_source=electricity" \
  --data-urlencode "include_explanation=true" | jq '.'
```

**Verification:**
- [ ] Intent: BASELINE
- [ ] Include explanation=true
- [ ] Natural language descriptions

**Status:** ‚è≥ NOT TESTED

---

#### Query 17.3: List all models

**OVOS Query:** `"List all baseline models in the system"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/baseline/models" | jq '.'
```

**Verification:**
- [ ] Intent: BASELINE or FACTORY_OVERVIEW
- [ ] No machine filter
- [ ] All models across all machines

**Status:** ‚è≥ NOT TESTED

---

#### Query 17.4-17.8: Additional model listing tests (By UUID, Natural gas models, Multiple energy sources, Model versions, Performance metrics)

**Status:** ‚è≥ NOT TESTED

---

### EP18: Baseline Predict ‚≠ê CRITICAL - FAILING

**API Endpoint:** `POST /api/v1/baseline/predict`  
**Parameters:** `seu_name`, `energy_source`, `features`, `include_message`  
**Purpose:** Get baseline prediction for given operating conditions

---

#### Query 18.1: Expected energy baseline (KNOWN FAILING)

**OVOS Query:** `"What's the expected energy for Compressor-1?"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/baseline/predict" \
  -H "Content-Type: application/json" \
  -d '{
    "seu_name": "Compressor-1",
    "energy_source": "electricity",
    "features": {
      "total_production_count": 5000000,
      "avg_outdoor_temp_c": 22.0,
      "avg_pressure_bar": 7.0,
      "avg_load_factor": 0.85
    },
    "include_message": true
  }' | jq '.'
```

**Expected curl Output:**
```json
{
  "machine_id": "...",
  "model_version": 46,
  "predicted_energy_kwh": 91.2,
  "message": "Compressor-1 is predicted to consume 91.2 kWh under these conditions"
}
```

**Verification:**
- [ ] Intent: BASELINE or FORECAST
- [ ] **CRITICAL:** API must be `POST /baseline/predict` NOT `GET /machines/status`
- [ ] Machine: Compressor-1 extracted
- [ ] Features: Extracted from context or defaults
- [ ] Response: predicted_energy_kwh (NOT current energy!)
- [ ] Voice message included

**Status:** ‚è≥ NOT TESTED | Expected: ‚ùå FAIL

**Known Issue:** Currently classified as ENERGY_QUERY, calls `/machines/status`, returns CURRENT energy instead of BASELINE prediction

---

#### Query 18.2: Production-based forecast (KNOWN FAILING)

**OVOS Query:** `"Predict energy consumption for 500 units production"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/baseline/predict" \
  -H "Content-Type: application/json" \
  -d '{
    "seu_name": "Compressor-1",
    "energy_source": "electricity",
    "features": {
      "total_production_count": 500
    },
    "include_message": true
  }' | jq '.'
```

**Verification:**
- [ ] Intent: FORECAST
- [ ] **CRITICAL:** API must be `POST /baseline/predict` NOT `/anomaly/detect`!
- [ ] Production units: 500 extracted
- [ ] Machine: Inferred from context or prompted
- [ ] Response: Energy prediction for 500 units

**Status:** ‚è≥ NOT TESTED | Expected: ‚ùå FAIL

**Known Issue:** Currently MISCLASSIFIED as ANOMALY_DETECTION (!!) which is completely wrong

---

#### Query 18.3-18.12: Additional baseline prediction tests (Temperature, pressure, load factor variations, different machines)

**Status:** ‚è≥ NOT TESTED

#### Query 18.3: Temperature variation

**OVOS Query:** `"Predict energy for Compressor-1 at 30 degrees"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/baseline/predict" \
  -H "Content-Type: application/json" \
  -d '{
    "seu_name": "Compressor-1",
    "energy_source": "electricity",
    "features": {
      "avg_outdoor_temp_c": 30.0,
      "total_production_count": 5000000
    },
    "include_message": true
  }' | jq '.'
```

**Verification:**
- [ ] Intent: FORECAST or BASELINE
- [ ] Temperature: 30¬∞C extracted
- [ ] Prediction adjusts for temp

**Status:** ‚è≥ NOT TESTED

---

#### Query 18.4: Pressure variation

**OVOS Query:** `"What's the expected energy at 8 bar pressure?"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/baseline/predict" \
  -H "Content-Type: application/json" \
  -d '{
    "seu_name": "Compressor-1",
    "energy_source": "electricity",
    "features": {
      "avg_pressure_bar": 8.0,
      "total_production_count": 5000000
    },
    "include_message": true
  }' | jq '.'
```

**Verification:**
- [ ] Pressure: 8 bar extracted
- [ ] Prediction includes pressure impact

**Status:** ‚è≥ NOT TESTED

---

#### Query 18.5: Load factor prediction

**OVOS Query:** `"Predict energy at 90% load factor"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/baseline/predict" \
  -H "Content-Type: application/json" \
  -d '{
    "seu_name": "Compressor-1",
    "energy_source": "electricity",
    "features": {
      "avg_load_factor": 0.90
    },
    "include_message": true
  }' | jq '.'
```

**Verification:**
- [ ] Load factor: 0.90 (90%)
- [ ] Voice: "at 90 percent load"

**Status:** ‚è≥ NOT TESTED

---

#### Query 18.6: Different machine - HVAC

**OVOS Query:** `"Expected energy for HVAC-Main"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/baseline/predict" \
  -H "Content-Type: application/json" \
  -d '{
    "seu_name": "HVAC-Main",
    "energy_source": "electricity",
    "features": {},
    "include_message": true
  }' | jq '.'
```

**Verification:**
- [ ] Machine: HVAC-Main
- [ ] Default features used
- [ ] Works for different machine types

**Status:** ‚è≥ NOT TESTED

---

#### Query 18.7: Multi-feature prediction

**OVOS Query:** `"Predict energy with temp 25, pressure 7.5, and 5 million units"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/baseline/predict" \
  -H "Content-Type: application/json" \
  -d '{
    "seu_name": "Compressor-1",
    "energy_source": "electricity",
    "features": {
      "avg_outdoor_temp_c": 25.0,
      "avg_pressure_bar": 7.5,
      "total_production_count": 5000000
    },
    "include_message": true
  }' | jq '.'
```

**Verification:**
- [ ] Multiple features extracted
- [ ] Temp: 25¬∞C
- [ ] Pressure: 7.5 bar
- [ ] Production: 5M units

**Status:** ‚è≥ NOT TESTED

---

#### Query 18.8-18.12: Additional predictions (Low production, High temp, Natural gas, Boiler predictions, Without message)

**Status:** ‚è≥ NOT TESTED

---

### EP19: Model Details

**API Endpoint:** `GET /api/v1/baseline/model/{model_id}`  
**Parameters:** `model_id` (in path), optional query params for explanation  
**Purpose:** Get detailed information about a specific baseline model

---

#### Query 19.1: Get model details

**OVOS Query:** `"Show me details for baseline model 46"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/baseline/model/46" | jq '.'
```

**Verification:**
- [ ] Intent: BASELINE
- [ ] API: `/baseline/model/46`
- [ ] Shows model version, features, performance metrics

**Status:** ‚è≥ NOT TESTED

---

#### Query 19.2: Model with explanation

**OVOS Query:** `"Explain baseline model 46"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/baseline/model/46?include_explanation=true" | jq '.'
```

**Verification:**
- [ ] Intent: BASELINE
- [ ] include_explanation=true
- [ ] Natural language model description

**Status:** ‚è≥ NOT TESTED

---

#### Query 19.3-19.6: Additional model details (Latest model, Model performance, Feature importance, Training date)

**Status:** ‚è≥ NOT TESTED

---

### EP20: Train Baseline Model

**API Endpoint:** `POST /api/v1/baseline/train-seu`  
**Parameters:** `seu_name`, `energy_source`, `start_date`, `end_date`  
**Purpose:** Train a new baseline model for a machine

---

#### Query 20.1: Train model for Compressor-1

**OVOS Query:** `"Train a baseline model for Compressor-1"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/baseline/train-seu" \
  -H "Content-Type: application/json" \
  -d '{
    "seu_name": "Compressor-1",
    "energy_source": "electricity",
    "start_date": "2025-10-01",
    "end_date": "2025-11-20"
  }' | jq '.'
```

**Verification:**
- [ ] Intent: BASELINE or custom TRAIN
- [ ] API: `POST /baseline/train-seu`
- [ ] Machine: Compressor-1
- [ ] Training initiated
- [ ] Returns model_id

**Status:** ‚è≥ NOT TESTED

---

#### Query 20.2: Train with date range

**OVOS Query:** `"Train baseline using last month's data"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/baseline/train-seu" \
  -H "Content-Type: application/json" \
  -d "{
    \"seu_name\": \"HVAC-Main\",
    \"energy_source\": \"electricity\",
    \"start_date\": \"$(date -u -d '1 month ago' +%Y-%m-01)\",
    \"end_date\": \"$(date -u -d '1 month ago' +%Y-%m-%d)\"
  }" | jq '.'
```

**Verification:**
- [ ] Intent: BASELINE
- [ ] Date range: last month
- [ ] Automatic date calculation

**Status:** ‚è≥ NOT TESTED

---

#### Query 20.3-20.5: Additional training tests (Different machines, Natural gas, Custom date ranges)

**Status:** ‚è≥ NOT TESTED

---

## üß™ BATCH 6: KPIs & PERFORMANCE ANALYTICS

---

### EP21: All KPIs

**API Endpoint:** `GET /api/v1/kpi/all`  
**Parameters:** Optional: `start_time`, `end_time`  
**Purpose:** Get all KPIs (energy, cost, production, efficiency)

---

#### Query 21.1: Get all KPIs

**OVOS Query:** `"Show me all KPIs"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/kpi/all" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW or custom KPI
- [ ] API: `/kpi/all`
- [ ] Reports all KPI categories
- [ ] Energy, cost, production, efficiency metrics

**Status:** ‚è≥ NOT TESTED

---

#### Query 21.2: KPIs for today

**OVOS Query:** `"What are today's KPIs?"`

**curl Command:**
```bash
curl -G "http://10.33.10109:8001/api/v1/kpi/all" \
  --data-urlencode "start_time=$(date -u +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] Time: today
- [ ] Voice: Summary of key metrics

**Status:** ‚è≥ NOT TESTED

---

#### Query 21.3-21.6: Additional KPI tests (This week, This month, Performance trends, Historical comparison)

**Status:** ‚è≥ NOT TESTED

---

### EP22: Energy Cost KPIs

**API Endpoint:** `GET /api/v1/kpi/energy-cost`  
**Parameters:** Optional: `start_time`, `end_time`, `machine_id`  
**Purpose:** Get energy cost specific KPIs

---

#### Query 22.1: Energy cost KPIs

**OVOS Query:** `"Show energy cost KPIs"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/kpi/energy-cost" | jq '.'
```

**Verification:**
- [ ] Intent: COST_ANALYSIS
- [ ] API: `/kpi/energy-cost`
- [ ] Cost per kWh, total cost, trends

**Status:** ‚è≥ NOT TESTED

---

#### Query 22.2: Cost KPIs for machine

**OVOS Query:** `"What are the cost KPIs for Compressor-1?"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')

curl -G "http://10.33.10.109:8001/api/v1/kpi/energy-cost" \
  --data-urlencode "machine_id=$MACHINE_ID" | jq '.'
```

**Verification:**
- [ ] Intent: COST_ANALYSIS
- [ ] Machine: Compressor-1
- [ ] Machine-specific cost KPIs

**Status:** ‚è≥ NOT TESTED

---

#### Query 22.3-22.7: Additional cost KPI tests (Weekly trend, Monthly comparison, Cost per unit, Peak vs off-peak, Budget tracking)

**Status:** ‚è≥ NOT TESTED

---

### EP23: Analyze SEU Performance

**API Endpoint:** `POST /api/v1/performance/analyze`  
**Parameters:** `seu_name`, `energy_source`, optional time range  
**Purpose:** Analyze performance of Significant Energy Use

---

#### Query 23.1: Analyze Compressor performance

**OVOS Query:** `"Analyze performance of Compressor-1"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/performance/analyze" \
  -H "Content-Type: application/json" \
  -d '{
    "seu_name": "Compressor-1",
    "energy_source": "electricity"
  }' | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW or PERFORMANCE
- [ ] API: `POST /performance/analyze`
- [ ] SEU: Compressor-1
- [ ] Performance metrics, efficiency scores

**Status:** ‚è≥ NOT TESTED

---

#### Query 23.2: Performance with time range

**OVOS Query:** `"Analyze HVAC performance this month"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/performance/analyze" \
  -H "Content-Type: application/json" \
  -d "{
    \"seu_name\": \"HVAC-Main\",
    \"energy_source\": \"electricity\",
    \"start_time\": \"$(date -u +%Y-%m-%dT00:00:00Z)\",
    \"end_time\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\"
  }" | jq '.'
```

**Verification:**
- [ ] Intent: PERFORMANCE
- [ ] Time: this month
- [ ] Monthly performance analysis

**Status:** ‚è≥ NOT TESTED

---

#### Query 23.3-23.8: Additional performance tests (Compare periods, Efficiency trends, Baseline comparison, Anomaly impact, Production efficiency, Energy intensity)

**Status:** ‚è≥ NOT TESTED

---

### EP24: Performance Engine Health

**API Endpoint:** `GET /api/v1/performance/health`  
**Parameters:** None  
**Purpose:** Check performance engine status

---

#### Query 24.1: Check performance engine

**OVOS Query:** `"Is the performance engine running?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/performance/health" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW or HEALTH
- [ ] API: `/performance/health`
- [ ] Engine status, last run, metrics

**Status:** ‚è≥ NOT TESTED

---

#### Query 24.2-24.4: Additional health tests (Engine diagnostics, Last analysis time, Queue status)

**Status:** ‚è≥ NOT TESTED

---

### EP25: Performance Opportunities

**API Endpoint:** `GET /api/v1/performance/opportunities`  
**Parameters:** Optional: `seu_name`, `min_savings`, `limit`  
**Purpose:** Get energy saving opportunities

---

#### Query 25.1: Show opportunities

**OVOS Query:** `"What are the energy saving opportunities?"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/performance/opportunities" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW or OPPORTUNITIES
- [ ] API: `/performance/opportunities`
- [ ] Lists improvement opportunities
- [ ] Potential savings

**Status:** ‚è≥ NOT TESTED

---

#### Query 25.2: Opportunities for machine

**OVOS Query:** `"Show saving opportunities for Compressor-1"`

**curl Command:**
```bash
curl -G "http://10.33.10.109:8001/api/v1/performance/opportunities" \
  --data-urlencode "seu_name=Compressor-1" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] API: `/performance/opportunities`
- [ ] SEU filter: Compressor-1
- [ ] Machine-specific opportunities

**Status:** ‚è≥ NOT TESTED

---

#### Query 25.3-25.6: Additional opportunity tests (High savings only, Top 5 opportunities, By priority, Implementation cost)

**Status:** ‚è≥ NOT TESTED

---

### EP26: Create Action Plan

**API Endpoint:** `POST /api/v1/performance/action-plan`  
**Parameters:** `seu_name`, `opportunity_id`, `target_date`, `description`  
**Purpose:** Create action plan for improvement

---

#### Query 26.1: Create action plan

**OVOS Query:** `"Create an action plan for Compressor-1 efficiency improvement"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/performance/action-plan" \
  -H "Content-Type: application/json" \
  -d '{
    "seu_name": "Compressor-1",
    "opportunity_id": "OPP-001",
    "target_date": "2025-12-31",
    "description": "Improve compressor efficiency by 10%"
  }' | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW or ACTION_PLAN
- [ ] API: `POST /performance/action-plan`
- [ ] Plan created
- [ ] Returns action_plan_id

**Status:** ‚è≥ NOT TESTED

---

#### Query 26.2-26.5: Additional action plan creation tests

**Status:** ‚è≥ NOT TESTED

---

## üß™ BATCH 7: FORECASTING

---

### EP27: Short-term Forecast

**API Endpoint:** `GET /api/v1/forecast/short-term`  
**Parameters:** `machine_id`, `hours_ahead`, `confidence_level`  
**Purpose:** Get ML-based energy forecast

---

#### Query 27.1: Next 24 hours forecast

**OVOS Query:** `"Forecast energy for next 24 hours"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')

curl -G "http://10.33.10.109:8001/api/v1/forecast/short-term" \
  --data-urlencode "machine_id=$MACHINE_ID" \
  --data-urlencode "hours_ahead=24" | jq '.'
```

**Verification:**
- [ ] Intent: FORECAST
- [ ] API: `/forecast/short-term`
- [ ] Hours: 24
- [ ] Hourly predictions

**Status:** ‚è≥ NOT TESTED

---

#### Query 27.2: Tomorrow's forecast

**OVOS Query:** `"What's the forecast for tomorrow?"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=HVAC-Main" | jq -r '.[0].id')

curl -G "http://10.33.10.109:8001/api/v1/forecast/short-term" \
  --data-urlencode "machine_id=$MACHINE_ID" \
  --data-urlencode "hours_ahead=24" | jq '.'
```

**Verification:**
- [ ] Intent: FORECAST
- [ ] Time: tomorrow
- [ ] Voice: "Tomorrow's forecast..."

**Status:** ‚è≥ NOT TESTED

---

#### Query 27.3-27.10: Additional forecast tests (48 hours, Next week, Confidence intervals, Peak demand)

**Status:** ‚è≥ NOT TESTED

---

### EP28: Energy Demand Forecast (deprecated)

**API Endpoint:** `GET /api/v1/forecast/demand`  
**Parameters:** `timeframe`, `machine_id`

---

#### Query 28.1: Demand forecast

**OVOS Query:** `"Forecast energy demand"`

**curl Command:**
```bash
curl -G "http://10.33.10.109:8001/api/v1/forecast/demand" \
  --data-urlencode "timeframe=24h" | jq '.'
```

**Verification:**
- [ ] Intent: FORECAST
- [ ] API: `/forecast/demand` (deprecated)

**Status:** ‚è≥ NOT TESTED

---

#### Query 28.2-28.6: Additional demand tests

**Status:** ‚è≥ NOT TESTED

---

## üß™ BATCH 8: FACTORY & ANALYTICS

---

### EP29: List SEUs

**API Endpoint:** `GET /api/v1/seus`  
**Parameters:** Optional: `energy_source`

---

#### Query 29.1: List all SEUs

**OVOS Query:** `"List all significant energy uses"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/seus" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] API: `/seus`
- [ ] Lists all SEUs

**Status:** ‚è≥ NOT TESTED

---

#### Query 29.2-29.5: Additional SEU tests (By energy source, Priorities, Rankings)

**Status:** ‚è≥ NOT TESTED

---

### EP30: Factory Summary

**API Endpoint:** `GET /api/v1/factory/summary`

---

#### Query 30.1: Factory summary

**OVOS Query:** `"Give me a factory summary"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/factory/summary" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] Comprehensive summary

**Status:** ‚è≥ NOT TESTED

---

#### Query 30.2-30.8: Additional summary tests

**Status:** ‚è≥ NOT TESTED

---

### EP31: Top Consumers / Ranking ‚≠ê CRITICAL

**API Endpoint:** `GET /api/v1/analytics/top-consumers`  
**Parameters:** `metric`, `start_time`, `end_time`, `limit`

---

#### Query 31.1: Top 3 energy

**OVOS Query:** `"top 3"`

**curl Command:**
```bash
curl -G "http://10.33.10.109:8001/api/v1/analytics/top-consumers" \
  --data-urlencode "metric=energy" \
  --data-urlencode "limit=3" \
  --data-urlencode "start_time=$(date -u +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" | jq '.'
```

**Verification:**
- [ ] Intent: RANKING
- [ ] API: `/analytics/top-consumers`
- [ ] Metric: energy
- [ ] Limit: 3
- [ ] Voice: Lists top 3 machines with values

**Status:** ‚è≥ NOT TESTED

---

#### Query 31.2: Most efficient

**OVOS Query:** `"Which machine is most efficient?"`

**curl Command:**
```bash
curl -G "http://10.33.10.109:8001/api/v1/analytics/top-consumers" \
  --data-urlencode "metric=efficiency" \
  --data-urlencode "limit=1" \
  --data-urlencode "start_time=$(date -u +%Y-%m-%dT00:00:00Z)" \
  --data-urlencode "end_time=$(date -u +%Y-%m-%dT%H:%M:%SZ)" | jq '.'
```

**Verification:**
- [ ] Intent: RANKING
- [ ] Metric: efficiency
- [ ] Limit: 1
- [ ] Names most efficient machine

**Status:** ‚è≥ NOT TESTED

---

#### Query 31.3-31.12: Additional ranking tests (Cost, alerts, power, top 5, top 10, time ranges)

**Status:** ‚è≥ NOT TESTED

---

## üß™ BATCH 9: MULTI-ENERGY SUPPORT

---

### EP33: List Energy Types

**API Endpoint:** `GET /api/v1/machines/{id}/energy-types`

---

#### Query 33.1: List energy types for machine

**OVOS Query:** `"What energy types does Compressor-1 use?"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')

curl -s "http://10.33.10.109:8001/api/v1/machines/$MACHINE_ID/energy-types" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW or ENERGY_QUERY
- [ ] API: `/machines/{id}/energy-types`
- [ ] Lists available energy sources

**Status:** ‚è≥ NOT TESTED

---

#### Query 33.2-33.5: Additional energy type tests

**Status:** ‚è≥ NOT TESTED

---

### EP34: Get Readings by Energy Type

**API Endpoint:** `GET /api/v1/machines/{id}/energy/{type}`

---

#### Query 34.1: Electricity readings

**OVOS Query:** `"Show electricity consumption for Compressor-1"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')

curl -s "http://10.33.10.109:8001/api/v1/machines/$MACHINE_ID/energy/electricity" | jq '.'
```

**Verification:**
- [ ] Intent: ENERGY_QUERY
- [ ] Energy type: electricity
- [ ] Type-specific readings

**Status:** ‚è≥ NOT TESTED

---

#### Query 34.2-34.8: Additional energy type readings (Natural gas, Steam, Compressed air, Time ranges, Comparisons)

**Status:** ‚è≥ NOT TESTED

---

### EP35: Multi-Energy Summary

**API Endpoint:** `GET /api/v1/machines/{id}/energy-summary`

---

#### Query 35.1: Energy summary all types

**OVOS Query:** `"Show energy summary for all types"`

**curl Command:**
```bash
MACHINE_ID=$(curl -s "http://10.33.10.109:8001/api/v1/machines?search=Compressor-1" | jq -r '.[0].id')

curl -s "http://10.33.10.109:8001/api/v1/machines/$MACHINE_ID/energy-summary" | jq '.'
```

**Verification:**
- [ ] Intent: ENERGY_QUERY or FACTORY_OVERVIEW
- [ ] All energy types summary
- [ ] Breakdown by type

**Status:** ‚è≥ NOT TESTED

---

#### Query 35.2-35.7: Additional multi-energy tests

**Status:** ‚è≥ NOT TESTED

---

## üß™ BATCH 10: DEPRECATED OVOS ENDPOINTS ‚ö†Ô∏è

---

### EP36-39: Deprecated OVOS endpoints

**NOTE:** These endpoints are deprecated but still functional. Use main endpoints instead.

---

#### Query 36.1: OVOS summary (deprecated)

**OVOS Query:** `"OVOS factory summary"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/ovos/summary" | jq '.'
```

**Verification:**
- [ ] API: `/ovos/summary` (deprecated)
- [ ] Warning displayed
- [ ] Use `/factory/summary` instead

**Status:** ‚è≥ NOT TESTED

---

#### Query 36.2: OVOS summary check

**OVOS Query:** `"Check factory status"` (Legacy)

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/ovos/summary" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] Returns summary object

**Status:** ‚è≥ NOT TESTED

---

### EP37: OVOS Top Consumers (Deprecated)

**API Endpoint:** `GET /api/v1/ovos/top-consumers`  
**Parameters:** None  
**Purpose:** Legacy endpoint for top consumers (Use EP31 instead)

---

#### Query 37.1: Top consumers (Legacy)

**OVOS Query:** `"Who are the top consumers?"` (Legacy intent)

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/ovos/top-consumers" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW
- [ ] API: `/ovos/top-consumers`
- [ ] Returns list of top consumers
- [ ] Check for deprecation warning headers

**Status:** ‚è≥ NOT TESTED

---

### EP38: OVOS Machine Status (Deprecated)

**API Endpoint:** `GET /api/v1/ovos/machines/{machine_name}/status`  
**Parameters:** `machine_name` (in path)  
**Purpose:** Legacy endpoint for machine status (Use EP6 instead)

---

#### Query 38.1: Status check (Legacy)

**OVOS Query:** `"Status of Compressor-1"` (Legacy intent)

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/ovos/machines/Compressor-1/status" | jq '.'
```

**Verification:**
- [ ] Intent: MACHINE_STATUS
- [ ] API: `/ovos/machines/.../status`
- [ ] Returns status object
- [ ] Check for deprecation warning

**Status:** ‚è≥ NOT TESTED

---

### EP39: OVOS Forecast (Deprecated)

**API Endpoint:** `GET /api/v1/ovos/forecast/tomorrow`  
**Parameters:** None  
**Purpose:** Legacy endpoint for tomorrow's forecast (Use EP27 instead)

---

#### Query 39.1: Forecast tomorrow (Legacy)

**OVOS Query:** `"Forecast for tomorrow"` (Legacy intent)

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/ovos/forecast/tomorrow" | jq '.'
```

**Verification:**
- [ ] Intent: FORECAST
- [ ] API: `/ovos/forecast/tomorrow`
- [ ] Returns forecast data
- [ ] Check for deprecation warning

**Status:** ‚è≥ NOT TESTED

---

## üß™ BATCH 11: ALERTS & SUBSCRIPTIONS

---

### EP40: Subscribe to Alerts

**API Endpoint:** `POST /api/v1/alerts/subscribe`

---

#### Query 40.1: Subscribe to alerts

**OVOS Query:** `"Subscribe me to critical alerts"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/alerts/subscribe" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "severity": ["critical", "warning"],
    "machines": []
  }' | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW or ALERTS
- [ ] API: `POST /alerts/subscribe`
- [ ] Subscription created

**Status:** ‚è≥ NOT TESTED

---

#### Query 40.2-40.6: Additional alert tests

**Status:** ‚è≥ NOT TESTED

---

## üß™ BATCH 12: ISO 50001 COMPLIANCE

---

### EP41: Energy Performance Indicators Report

**API Endpoint:** `GET /api/v1/iso50001/enpi-report`

---

#### Query 41.1: Get EnPI report

**OVOS Query:** `"Show energy performance indicators report"`

**curl Command:**
```bash
curl -G "http://10.33.10.109:8001/api/v1/iso50001/enpi-report" \
  --data-urlencode "start_date=$(date -u -d '1 month ago' +%Y-%m-01)" \
  --data-urlencode "end_date=$(date -u +%Y-%m-%d)" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW or ISO50001
- [ ] API: `/iso50001/enpi-report`
- [ ] ISO 50001 EnPI metrics

**Status:** ‚è≥ NOT TESTED

---

#### Query 41.2-41.6: Additional EnPI tests

**Status:** ‚è≥ NOT TESTED

---

### EP42: Create ISO Action Plan

**API Endpoint:** `POST /api/v1/iso50001/action-plans`

---

#### Query 42.1: Create action plan

**OVOS Query:** `"Create an ISO action plan for energy reduction"`

**curl Command:**
```bash
curl -X POST "http://10.33.10.109:8001/api/v1/iso50001/action-plans" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "Reduce Compressor Energy by 10%",
    "description": "Optimize compressor operation",
    "target_date": "2025-12-31",
    "responsible_person": "Energy Manager"
  }' | jq '.'
```

**Verification:**
- [ ] Intent: ACTION_PLAN or ISO50001
- [ ] API: `POST /iso50001/action-plans`
- [ ] Plan created

**Status:** ‚è≥ NOT TESTED

---

#### Query 42.2-42.5: Additional action plan creation tests

**Status:** ‚è≥ NOT TESTED

---

### EP43: List ISO Action Plans

**API Endpoint:** `GET /api/v1/iso50001/action-plans`

---

#### Query 43.1: List all action plans

**OVOS Query:** `"List all ISO action plans"`

**curl Command:**
```bash
curl -s "http://10.33.10.109:8001/api/v1/iso50001/action-plans" | jq '.'
```

**Verification:**
- [ ] Intent: FACTORY_OVERVIEW or ISO50001
- [ ] API: `/iso50001/action-plans`
- [ ] All plans listed

**Status:** ‚è≥ NOT TESTED

---

#### Query 43.2-43.6: Additional list tests (Active plans, Completed, By status, By priority)

**Status:** ‚è≥ NOT TESTED

---

### EP44: Update Action Plan Progress

**API Endpoint:** `PUT /api/v1/iso50001/action-plans/{id}/progress`

---

#### Query 44.1: Update progress

**OVOS Query:** `"Update action plan progress to 50 percent"`

**curl Command:**
```bash
curl -X PUT "http://10.33.10.109:8001/api/v1/iso50001/action-plans/1/progress" \
  -H "Content-Type: application/json" \
  -d '{
    "progress_percent": 50,
    "status": "in_progress",
    "notes": "Halfway through implementation"
  }' | jq '.'
```

**Verification:**
- [ ] Intent: ACTION_PLAN or ISO50001
- [ ] API: `PUT /iso50001/action-plans/{id}/progress`
- [ ] Progress updated

**Status:** ‚è≥ NOT TESTED

---

#### Query 44.2-44.5: Additional progress tests (Complete plan, Mark blocked, Add notes, Change status)

**Status:** ‚è≥ NOT TESTED

---

## üîß FIXES LOG

### Fix 1: [Date] - [Issue]
**Problem:** `{Description}`  
**Root Cause:** `{Analysis}`  
**Solution:** `{Code changes}`  
**Files Modified:** `{List}`  
**Tests Fixed:** `{List}`  
**Re-test Results:** `{Status}`

---

## üìä COMPLETION METRICS

**Overall Progress:** 0/300 queries tested (0%)

**By Batch:**
- BATCH 1: 0/19 queries (0%)
- BATCH 2: 0/37 queries (0%)
- BATCH 3: 0/31 queries (0%)
- BATCH 4: 0/28 queries (0%)
- BATCH 5: 0/31 queries (0%)
- BATCH 6: 0/36 queries (0%)
- BATCH 7: 0/16 queries (0%)
- BATCH 8: 0/31 queries (0%)
- BATCH 9: 0/20 queries (0%)
- BATCH 10: 0/22 queries (0%)
- BATCH 11: 0/6 queries (0%)
- BATCH 12: 0/22 queries (0%)

**Critical Endpoints (‚≠ê):**
- EP6: Machine Status by Name - 0/12 queries (0%)
- EP9: Energy Time-Series - 0/10 queries (0%) - **KNOWN FAILING**
- EP18: Baseline Predict - 0/12 queries (0%) - **KNOWN FAILING**
- EP31: Top Consumers - 0/12 queries (0%)

**Known Failures:** 3 documented (EP9.1, EP18.1, EP18.2)

---

## üöÄ NEXT STEPS

1. **START HERE:** BATCH 1, EP1, Query 1.1
2. Run curl command ‚Üí Save output
3. Run OVOS query ‚Üí Save response
4. Compare: Intent ‚úì API ‚úì Params ‚úì Match ‚úì Voice ‚úì
5. Mark PASS/FAIL
6. If FAIL ‚Üí Fix ‚Üí Re-test ‚Üí Iterate
7. Move to next query ONLY after PASS
8. **DO NOT skip ahead**
9. Complete all 300 queries systematically
10. Achieve 100% coverage (300/300 PASS)

---

## üìù TESTING ENVIRONMENT SETUP

### Terminal 1: OVOS Logs
```bash
journalctl -u ovos-core -f | grep -E "intent|api|endpoint|IntentType|_call_enms_api"
```

### Terminal 2: curl Commands
```bash
cd /tmp
# Run curl commands here, save outputs as epN_qN_curl.json
```

### Terminal 3: OVOS Queries
```bash
# Use OVOS CLI or voice interface
# Say/type the OVOS queries
```

### Prerequisites
```bash
# Ensure API is running
curl -s http://10.33.10.109:8001/api/v1/health | jq '.'

# Ensure OVOS is running
systemctl status ovos-core

# Install jq if needed
sudo apt install jq -y
```

---

**END OF TESTING PLAN**

**This document contains:**
- ‚úÖ ALL 44 unique API endpoints
- ‚úÖ Organized in 12 logical batches
- ‚úÖ ~300 total queries (5-12 per endpoint)
- ‚úÖ UNIQUE curl command for EACH query
- ‚úÖ Complete testing methodology
- ‚úÖ Known failures documented (EP9.1, EP18.1, EP18.2)
- ‚úÖ Progress tracking built-in
- ‚úÖ Fixes log ready
- ‚úÖ Ready for systematic end-to-end testing

**READY TO START TESTING!**
